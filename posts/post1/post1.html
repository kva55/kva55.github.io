<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #333;
            color: #fff;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #222;
            padding: 1em 0;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 2em;
        }
        nav {
            display: flex;
            justify-content: center;
            background-color: #444;
            padding: 0.5em 0;
        }
        nav a {
            color: #ddd;
            text-decoration: none;
            padding: 0.5em 1em;
            margin: 0 0.5em;
            background-color: #555;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        nav a:hover {
            background-color: #666;
        }
        main {
            margin: 2em auto;
            max-width: 800px;
            padding: 2em;
            background: #444;
            border-radius: 8px;
            box-sizing: border-box;
        }
        h2, h3, h4 {
            color: #ffcc00;
			margin: 1em auto;
            display: block;
			max-width: 100%;
            height: auto;
            border-radius: 8px;
        }
        p {
            line-height: 1.6;
            margin: 1em 0;
        }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1em 0;
        }
        pre {
            background-color: #222;
            padding: 1em;
            border-radius: 8px;
            overflow-x: auto;
            color: #ddd;
        }
        code {
            font-family: 'Courier New', monospace;
            background-color: #555;
            padding: 0.2em 0.4em;
            border-radius: 4px;
            color: #ffcc00;
        }
        blockquote {
            border-left: 4px solid #ffcc00;
            margin: 1em 0;
            padding: 0.5em 1em;
            background-color: #555;
            color: #ddd;
        }
        ul, ol {
            margin: 1em 0;
            padding-left: 1.5em;
        }
        ul li, ol li {
            margin: 0.5em 0;
        }
        footer {
            background-color: #222;
            text-align: center;
            padding: 1.5em 0;
        }
		img {
            max-width: 60%;
            height: auto;
            border-radius: 8px;
            margin: 1em auto;
            display: block;
        }
		a {
            color: #ffcc00;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
		<h1>Elysee Franchuk <span style="font-size: 0.8em;">(kva55)</span></h1>
    </header>

    <!-- Navigation -->
    <nav>
        <a href="/index.html">About</a>
        <a href="/blog.html">Blogs</a>
        <a href="/contact.html">Contact</a>
    </nav>

    <!-- Main Content -->
    <main>
		<h2>Apache Tomcat - CVE-2024-54677 (Crash Cart) <span style="font-size: 0.8em;"></span></h2>
		<img src="cat.webp" alt="Placeholder image">
        
		<br>
		<p>
			I'd like to walk you through a vulnerability I identified in Apache Tomcat that can lead to a Denial-of-Service (DoS) attack. 
			First, let me provide context on the type of vulnerability it is and the specific conditions required for exploitation on an Apache Tomcat system.
		</p>
		
		<p> 
			I'll also share some interesting data on the number of vulnerable Apache Tomcat servers that meet these conditions, highlighting the potential impact of this issue.
		</p>
		
		<p>
			Finally, I'll cover mitigations and remediations for this vulnerability. Although fixes were implemented starting from Apache Tomcat version 9.0.98, we'll review additional recommendations made by the Apache Development team to help ensure your systems are secure.
		</p>

        <h3>Is Uncontrolled Resource Consumption Dangerous?</h3>
		<p> 
			While it may seem like an obvious answer, the key factor in determining whether resource exhaustion occurs depends on where the consumption happens within the system. For example, internal functions may require dynamic allocation of memory that can lead to uncontrolled resource consumption scenarios.
			<a href="https://cwe.mitre.org/data/definitions/400.html"> CWE-400</a> is the common weakness enumeration ID that details the term, conditions and mitigations for resource exhuastion.
		</p>
		<p>	
			In order for this to occur, there must a lack of throttling, mismanagement of object references, or not closing the resource post processing. This means that the resource can either be tied up in memory, on disk, or as forms of compute like tasks and threads.
			In other words, if you don't use it, you should lose it. There are legitimate reasons for maintaining information related to sessions, caching, and "intended functionality" but should be added part of the architecture and accounted for.
		</p>
		<p>
			In situations where resource exhuastion is available to remote users, a significant risk of a DoS attack becomes apparent. If the resource exhuastion is behind authentication, e.g. users need to have an account to access the vulnerable function, the risk changes.
			Then there's functions that are only accessible to localhost, which would require users to be local to where the system is. This type of attack is limited and generally has a low-risk.
		</p>	
        
		<h3>Vulnerability Identification</h3>
		<p>
			This vulnerability was first discovered in the carts.jsp program, which is included in Apache Tomcat's examples. This example program can be enabled during the installation process or by configuring it separately. However, by default, it is disabled to prevent unauthorized access.
			For testing, I ended up modifying this file:
			
			<code> <tomcat>/webapps/manager/META-INF/context.xml</code> so that my remote machine could interact with the examples directory.
			
		</p>
		
		<img src="apache_1.png" alt="Placeholder image">
		
		<p> With the carts.jsp program enabled, an additional layer of vulnerability was introduced. Specifically, the lack of adequate input validation made it possible for malicious inputs to bypass intended limits. The good news is that, without this specifically being accessible to remote users the risk is relatively low. </p>
		<p> 
			The most significant concern lies in the fact that versions prior to 8.5.4 allow access to vulnerabilities such as CVE-2024-54677. With hundreds of Apache Tomcat instances running on outdated versions, many are susceptible to this issue and other more critical vulnerabilities.
			The scope of CVE-2024-54677 is particularly interesting, affecting not only older versions (9.0.0.M1 through 9.9.97) but also earlier major releases (11.0.0-M1 through 11.0.1). Moreover, the fact that it affects even the first milestone release of version 10 (10.0.1-M1 through 10.1.33) indicates resource consumption for this type of interaction was not anticipated.
		</p>
		
		<h3>Closing Thoughts</h3>
		<p>
			This vulnerability discovery serves as a valuable reminder of the resource exhaustion weaknesses that can exist within systems for decades. Historically, Apache Tomcat instances were vulnerable to this vulnerability due to inadequate access controls. However, modern versions of the software have introduced restrictions to localhost access which significantly reduces the risk of exploitation. 
			On the other hand, internal non-internet facing systems often require customized access controls, which can introduce this vulnerability to systems with examples enabled.
		</p>
		
		<h4>References</h4>
        <ul>
                <li>https://stackoverflow.com/questions/36703856/access-tomcat-manager-app-from-different-host</li>
                <li>https://www.cve.org/CVERecord?id=CVE-2024-54677</li>
                <li>https://lists.apache.org/thread/tdtbbxpg5trdwc2wnopcth9ccvdftq2n</li>
        </ul>
        
    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 <strong>Elysee Franchuk</strong> (kva55). All rights reserved.</p>
    </footer>
</body>
</html>
